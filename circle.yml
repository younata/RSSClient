machine:
  xcode:
    version: 7.3

dependencies:
  override:
    - brew update
    - brew upgrade carthage
    - openssl aes-256-cbc -k "$MOBILE_PROVISION_DECRYPT_KEY" -in ci/rNews.mobileprovision.enc -d -a -out ci/rNews.mobileprovision
    - carthage build Kanna --platform ios
    - bundle

test:
  override:
    - bundle exec fastlane test
  post:
    - mv ~/Library/Logs/scan/* $CIRCLE_ARTIFACTS/

deployment:
  beta_distribution:
    branch: master
    commands:
      - bundle exec fastlane deploy_testflight


